<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Work Hub</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="icon" type="image/svg+xml" href="./icon-ver.black.svg">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; overflow: hidden; }

    :root {
      --sidebar: 240px;
      --sidebar-collapsed: 60px;
      --header: 56px;
      --bg-overlay: rgba(0,0,0,0.4);
      --card-bg: rgba(255,255,255,0.12);
      --card-hover: rgba(255,255,255,0.18);
      --sidebar-bg: rgba(57, 57, 55,0.95);
      --text: #ffffff;
      --text-dim: rgba(255,255,255,0.7);
      --border: rgba(255,255,255,0.1);
    }

    body { font-family: 'Inter', sans-serif; color: var(--text); display: flex; }
    body.short-break { --bg-overlay: rgba(43,172,118,0.35); }
    body.long-break { --bg-overlay: rgba(18,100,163,0.35); }

    #bg-container { position: fixed; inset: 0; z-index: -1; }
    .bg-img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 2.5s; pointer-events: none; }
    .bg-img.active { opacity: 1; }
    #bg-overlay { position: fixed; inset: 0; background: var(--bg-overlay); pointer-events: none; transition: background 0.6s; }

    /* „Çµ„Ç§„Éâ„Éê„Éº */
    .sidebar { width: var(--sidebar); height: 100vh; background: var(--sidebar-bg); backdrop-filter: blur(20px); border-right: 1px solid var(--border); display: flex; flex-direction: column; transition: width 0.3s; z-index: 100; }
    .sidebar.collapsed { width: var(--sidebar-collapsed); }
    .sidebar-header { height: var(--header); padding: 0 16px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border); }
    .sidebar-logo { display: flex; align-items: center; gap: 10px; font-size: 18px; font-weight: 800; white-space: nowrap; overflow: hidden; }
    .sidebar-logo-icon { width: 28px; height: 28px; background: #2bac76; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0; }
    .sidebar-toggle { width: 28px; height: 28px; background: rgba(255,255,255,0.1); border: none; border-radius: 5px; color: var(--text); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
    .sidebar-toggle:hover { background: rgba(255,255,255,0.2); }
    .sidebar-nav { flex: 1; overflow-y: auto; padding: 10px; }
    .sidebar-nav::-webkit-scrollbar { width: 5px; }
    .sidebar-nav::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }
    .nav-section { margin-bottom: 20px; }
    .nav-section-title { font-size: 11px; font-weight: 700; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.5px; padding: 0 10px; margin-bottom: 6px; white-space: nowrap; overflow: hidden; z-index: 10;}
    .sidebar.collapsed .nav-section-title { opacity: 0; height: 0; margin: 0; padding: 0; }
    .nav-item { display: flex; align-items: center; gap: 10px; padding: 8px 10px; border-radius: 6px; cursor: pointer; transition: all 0.2s; margin-bottom: 2px; position: relative; }
    .nav-item:hover { background: rgba(255,255,255,0.1); }
    .nav-item.active { background: #1264a3; font-weight: 600; }
    .nav-icon { width: 18px; height: 18px; flex-shrink: 0; }
    .nav-icon svg { width: 100%; height: 100%; }
    .nav-label { font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .sidebar.collapsed .nav-label { opacity: 0; width: 0; }
    .nav-badge { margin-left: auto; background: #2bac76; font-size: 10px; font-weight: 700; padding: 2px 6px; border-radius: 10px; min-width: 16px; text-align: center; }
    .sidebar.collapsed .nav-badge { position: absolute; right: 6px; top: 6px; }
    .shortcut-hint { font-size: 10px; opacity: 0.5; margin-left: auto; }
    .sidebar.collapsed .shortcut-hint { display: none; }

    /* „É°„Ç§„É≥„Ç®„É™„Ç¢ */
    .main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
    .header { height: var(--header); padding: 0 24px; display: flex; align-items: center; gap: 16px; backdrop-filter: blur(10px); background: rgba(0,0,0,0.2); border-bottom: 1px solid var(--border); }
    .search-wrap { flex: 1; max-width: 500px; position: relative; }
    .search-box { width: 100%; padding: 10px 40px 10px 36px; border: 1px solid var(--border); border-radius: 6px; font-size: 13px; background: rgba(255,255,255,0.15); color: var(--text); backdrop-filter: blur(10px); transition: all 0.3s; }
    .search-box::placeholder { color: var(--text-dim); }
    .search-box:focus { outline: none; background: rgba(255,255,255,0.25); border-color: rgba(255,255,255,0.4); box-shadow: 0 0 0 3px rgba(255,255,255,0.1); }
    .search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-dim); pointer-events: none; }
    .search-btn { position: absolute; right: 6px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.2); border: none; cursor: pointer; padding: 6px; color: var(--text); border-radius: 4px; transition: all 0.2s; }
    .search-btn:hover { background: rgba(255,255,255,0.3); }
    .header-actions { display: flex; gap: 10px; align-items: center; margin-left: auto; }
    .header-btn { width: 36px; height: 36px; background: rgba(255,255,255,0.15); border: none; border-radius: 6px; color: var(--text); cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; position: relative; }
    .header-btn:hover { background: rgba(255,255,255,0.25); }
    .header-btn.notify::after { content: ''; position: absolute; top: 8px; right: 8px; width: 6px; height: 6px; background: #e01e5a; border-radius: 50%; border: 2px solid none; }

    /* „Ç≥„É≥„ÉÜ„É≥„ÉÑ */
    .content { flex: 1; overflow-y: auto; padding: 24px; z-index: 0;}
    .content::-webkit-scrollbar { width: 8px; }
    .content::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 4px; }
    .section { display: none; animation: fadeIn 0.3s; }
    .section.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    .section-title { font-size: 24px; font-weight: 700; margin-bottom: 20px; text-shadow: 0 2px 8px rgba(0,0,0,0.1); z-index: 1;}

    /* „Çø„Ç§„Éû„Éº„Éí„Éº„É≠„Éº */
    .timer-hero { background: rgba(255,255,255,0.1); backdrop-filter: blur(20px); border-radius: 12px; padding: 40px; text-align: center; margin-bottom: 24px; border: 1px solid var(--border); box-shadow: 0 8px 32px rgba(0,0,0,0.3); }
    .timer-tabs { display: inline-flex; gap: 6px; margin-bottom: 32px; background: rgba(0,0,0,0.2); padding: 5px; border-radius: 10px; }
    .tab-btn { padding: 10px 24px; background: transparent; border: none; color: var(--text); font-size: 14px; font-weight: 600; cursor: pointer; border-radius: 7px; transition: all 0.2s; opacity: 0.6; }
    .tab-btn:hover { opacity: 0.8; background: rgba(255,255,255,0.05); }
    .tab-btn.active { background: rgba(255,255,255,0.2); opacity: 1; }
    .timer-display { font-size: 80px; font-weight: 800; font-variant-numeric: tabular-nums; margin-bottom: 28px; text-shadow: 0 4px 20px rgba(0,0,0,0.4); letter-spacing: 0.02em; }
    .timer-controls { display: flex; gap: 12px; justify-content: center; }
    .ctrl-btn { padding: 16px 40px; background: var(--text); border: none; border-radius: 10px; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 16px rgba(0,0,0,0.2); min-width: 110px; color: rgba(57, 57, 55,0.95 );}
    .ctrl-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 24px rgba(0,0,0,0.3); }

    /* „Ç´„Éº„Éâ„Ç∞„É™„ÉÉ„Éâ */
    .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
    .card { background: var(--card-bg); backdrop-filter: blur(20px); border-radius: 12px; padding: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); transition: all 0.3s; display: flex; flex-direction: column; overflow: hidden; border: 1px solid var(--border); min-height: 750px; }
    .card:hover { transform: translateY(-4px); box-shadow: 0 6px 25px rgba(0,0,0,0.2); background: var(--card-hover); }
    .card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; }
    .card-title { font-size: 16px; font-weight: 700; display: flex; align-items: center; gap: 8px; }
    .card-icon { width: 20px; height: 20px; }
    .card-action { background: rgba(255,255,255,0.15); border: none; border-radius: 5px; padding: 5px 10px; color: var(--text); font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
    .card-action:hover { background: rgba(255,255,255,0.25); }
    .card-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
    .card.wide { grid-column: span 2; }
    .card.tall { grid-row: span 2; }

    /* ÊôÇË®à */
    .clock-time { font-size: 42px; font-weight: 800; font-variant-numeric: tabular-nums; margin-bottom: 6px; text-shadow: 0 2px 12px rgba(0,0,0,0.3); }
    .clock-date { font-size: 14px; opacity: 0.85; margin-bottom: 16px; font-weight: 500; }
    .world-clock-item { display: flex; justify-content: space-between; padding: 10px 14px; background: rgba(255,255,255,0.1); border-radius: 6px; margin-bottom: 6px; font-size: 13px; font-weight: 600; transition: all 0.2s; }
    .world-clock-item:hover { background: rgba(255,255,255,0.15); transform: translateX(4px); }

    /* Â§©Ê∞ó */
    .weather-wrap { text-align: center; }
    .weather-icon-wrap { display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 12px; }
    .weather-icon { width: 56px; height: 56px; filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)); }
    .weather-desc { font-size: 20px; font-weight: 600; }
    .weather-temp { font-size: 48px; font-weight: 800; margin: 12px 0; text-shadow: 0 4px 16px rgba(0,0,0,0.3); }
    .weather-minmax { display: flex; justify-content: center; gap: 20px; font-size: 14px; color: var(--text-dim); margin-bottom: 10px; font-weight: 600; }
    .weather-loc { font-size: 13px; opacity: 0.7; }

    /* „Çπ„Éà„ÉÉ„Éó„Ç¶„Ç©„ÉÉ„ÉÅ„Éª„Çø„Ç§„Éû„Éº */
    .display-lg { font-size: 42px; font-weight: 800; font-variant-numeric: tabular-nums; margin-bottom: 16px; text-align: center; text-shadow: 0 2px 12px rgba(0,0,0,0.3); }
    .input-group { display: flex; gap: 10px; justify-content: center; align-items: center; margin-bottom: 16px; font-size: 18px; font-weight: 600; }
    .input-sm { width: 60px; padding: 10px; border: 1px solid var(--border); border-radius: 6px; text-align: center; font-weight: 700; background: rgba(255,255,255,0.15); color: var(--text); font-size: 16px; transition: all 0.2s; }
    .input-sm:focus { outline: none; border-color: rgba(255,255,255,0.5); background: rgba(255,255,255,0.25); box-shadow: 0 0 0 3px rgba(255,255,255,0.1); }
    .controls { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
    .btn { padding: 10px 20px; background: rgba(255,255,255,0.2); border: none; border-radius: 6px; color: var(--text); font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
    .btn:hover { background: rgba(255,255,255,0.3); transform: translateY(-2px); }
    .lap-list { max-height: 180px; overflow-y: auto; margin-top: 12px; }
    .lap-list::-webkit-scrollbar { width: 5px; }
    .lap-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    .lap-item { display: flex; justify-content: space-between; padding: 10px 12px; background: rgba(255,255,255,0.1); border-radius: 6px; margin-bottom: 6px; font-size: 13px; font-weight: 600; transition: all 0.2s; }
    .lap-item:hover { background: rgba(255,255,255,0.15); }

    /* „É°„É¢ */
    .memo { width: 100%; flex: 1; border: 1px solid var(--border); border-radius: 10px; padding: 14px; font-size: 14px; font-family: inherit; background: rgba(255,255,255,0.15); color: var(--text); line-height: 1.7; overflow-y: auto; transition: all 0.2s; }
    .memo:focus { outline: none; border-color: rgba(255,255,255,0.5); background: rgba(255,255,255,0.2); box-shadow: 0 0 0 3px rgba(255,255,255,0.1); }
    .memo:empty:before { content: attr(data-placeholder); color: var(--text-dim); }
    .toolbar { display: flex; gap: 5px; margin-bottom: 10px; padding: 6px; background: rgba(255,255,255,0.1); border-radius: 6px; }
    .toolbar-btn { width: 32px; height: 32px; background: rgba(255,255,255,0.1); border: none; border-radius: 4px; color: var(--text); font-size: 13px; font-weight: 700; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; }
    .toolbar-btn:hover { background: rgba(255,255,255,0.2); }

    /* Notion */
    .notion-iframe { width: 100%; flex: 1; border: none; border-radius: 10px; opacity: 0.85; transition: opacity 0.3s; }
    .notion-iframe:hover { opacity: 1; }

    /* Gemini */
    .gemini-wrap { display: flex; align-items: flex-end; gap: 10px; }
    .gemini-input-wrap { flex: 1; display: flex; flex-direction: column; }
    .gemini-input { width: 100%; min-height: 44px; max-height: 100px; border: 1px solid var(--border); border-radius: 10px; padding: 10px 12px; font-size: 14px; font-family: inherit; background: rgba(255,255,255,0.15); color: var(--text); line-height: 1.6; overflow-y: auto; transition: all 0.2s; }
    .gemini-input:focus { outline: none; border-color: rgba(255,255,255,0.5); background: rgba(255,255,255,0.2); box-shadow: 0 0 0 3px rgba(255,255,255,0.1); }
    .gemini-input:empty:before { content: attr(data-placeholder); color: var(--text-dim); }
    .gemini-send { padding: 10px 24px; background: #2bac76; border: none; border-radius: 8px; color: var(--text); font-size: 14px; font-weight: 700; cursor: pointer; transition: all 0.2s; height: 44px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
    .gemini-send:hover { background: #25a06a; transform: translateY(-2px); }

    /* „É¢„Éº„ÉÄ„É´ */
    .modal { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center; z-index: 10000; backdrop-filter: blur(4px); }
    .modal.show { display: flex; animation: fadeIn 0.3s; }
    .modal-content { background: rgba(255,255,255,0.98); backdrop-filter: blur(20px); border-radius: 16px; padding: 32px; max-width: 420px; width: 90%; box-shadow: 0 24px 48px rgba(0,0,0,0.5); animation: slideUp 0.4s; color: #333; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    .modal-title { font-size: 24px; font-weight: 800; margin-bottom: 24px; color: #393937; }
    .setting-item { margin-bottom: 20px; }
    .setting-label { display: block; font-size: 13px; font-weight: 700; color: #555; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
    .setting-input { width: 100%; padding: 12px 14px; border: 2px solid #ddd; border-radius: 8px; font-size: 15px; font-weight: 600; color: #333; background: white; transition: all 0.2s; }
    .setting-input:focus { outline: none; border-color: #1264a3; box-shadow: 0 0 0 3px rgba(18,100,163,0.1); }
    .modal-btns { display: flex; gap: 10px; margin-top: 28px; }
    .modal-btn { flex: 1; padding: 14px; border: none; border-radius: 10px; font-size: 15px; font-weight: 700; cursor: pointer; transition: all 0.2s; }
    .modal-btn.primary { background: #393937; color: white; }
    .modal-btn.primary:hover { background: #636362; transform: translateY(-2px); }
    .modal-btn.secondary { background: #636362; color: #ffffff; }
    .modal-btn.secondary:hover { background: #d8d8d8; }

    /* „Ç¢„É©„Éº„Éà */
    .alert { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.95); display: none; align-items: center; justify-content: center; z-index: 10001; }
    .alert.show { display: flex; animation: fadeIn 0.3s; }
    .alert-wrap { text-align: center; animation: slideUp 0.4s; }
    .alert-title { font-size: 56px; font-weight: 800; margin-bottom: 16px; text-shadow: 0 4px 16px rgba(0,0,0,0.5); }
    .alert-msg { font-size: 24px; margin-bottom: 32px; opacity: 0.9; }
    .alert-close { padding: 14px 40px; background: white; color: #333; border: none; border-radius: 10px; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s; box-shadow: 0 8px 24px rgba(0,0,0,0.3); }
    .alert-close:hover { transform: scale(1.05); }

    /* „Éï„É≠„Éº„ÉÜ„Ç£„É≥„Ç∞„Ç¶„Ç£„Ç∏„Çß„ÉÉ„Éà */
    .float { position: fixed; top: 70px; background: rgba(255,255,255,0.98); backdrop-filter: blur(20px); border-radius: 10px; padding: 12px 16px; box-shadow: 0 8px 24px rgba(0,0,0,0.25); cursor: pointer; z-index: 1000; opacity: 0; transform: translateY(-20px); pointer-events: none; transition: all 0.4s; }
    .float.show { opacity: 1; transform: translateY(0); pointer-events: auto; }
    .float:hover { transform: translateY(-2px) scale(1.05); }
    .float-timer { right: 24px; }
    .float-clock { left: calc(var(--sidebar) + 24px); transition: left 0.3s, opacity 0.4s, transform 0.4s; }
    .sidebar.collapsed ~ .main .float-clock { left: calc(var(--sidebar-collapsed) + 24px); }
    .float-time { font-size: 20px; font-weight: 800; color: #4a154b; font-variant-numeric: tabular-nums; }

    /* „ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥ */
    .quick-actions { position: fixed; bottom: 24px; right: 24px; display: flex; gap: 10px; z-index: 999; }
    .quick-btn { width: 56px; height: 56px; background: rgba(255,255,255,0.95); backdrop-filter: blur(20px); border: none; border-radius: 50%; box-shadow: 0 6px 20px rgba(0,0,0,0.3); cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; color: #4a154b; }
    .quick-btn:hover { transform: scale(1.1) translateY(-4px); box-shadow: 0 10px 30px rgba(0,0,0,0.4); }

    /* „ÉÄ„Éº„ÇØ„É¢„Éº„ÉâÂàá„ÇäÊõø„Åà„Éú„Çø„É≥ */
    .theme-toggle { width: 56px; height: 56px; background: rgba(255,255,255,0.95); backdrop-filter: blur(20px); border: none; border-radius: 50%; box-shadow: 0 6px 20px rgba(0,0,0,0.3); cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; color: #4a154b; }

    /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ */
    @media (max-width: 1024px) {
      .sidebar { position: fixed; z-index: 1000; transform: translateX(-100%); }
      .sidebar.open { transform: translateX(0); }
      .float-clock { left: 24px !important; }
      .cards { grid-template-columns: 1fr; }
      .card.wide, .card.tall { grid-column: auto; grid-row: auto; }
      .quick-actions { bottom: 16px; right: 16px; }
    }
    @media (max-width: 768px) {
      .timer-display { font-size: 64px; }
      .alert-title { font-size: 42px; }
      .alert-msg { font-size: 18px; }
    }
    .mobile-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 999; display: none; }
    .mobile-overlay.show { display: block; }
  </style>
</head>
<body>
  <div id="bg-container">
    <img class="bg-img active" src="background-image/bgimg-1.jpg" alt="">
    <img class="bg-img" src="" alt="">
  </div>
  <div id="bg-overlay"></div>

  <div class="alert" id="alert">
    <div class="alert-wrap">
      <div class="alert-title" id="alert-title">Time Up!</div>
      <div class="alert-msg" id="alert-msg">Finished your task</div>
      <button class="alert-close" onclick="hideAlert()">OK</button>
    </div>
  </div>

  <div class="modal" id="settings">
    <div class="modal-content">
      <div class="modal-title">Pomodoro Settings</div>
      <div class="setting-item">
        <label class="setting-label">Work Time (min)</label>
        <input type="number" class="setting-input" id="set-work" min="1" max="60" value="25">
      </div>
      <div class="setting-item">
        <label class="setting-label">Break Time (min)</label>
        <input type="number" class="setting-input" id="set-break" min="1" max="30" value="5">
      </div>
      <div class="setting-item">
        <label class="setting-label">Repeat (0 = ‚àû)</label>
        <input type="number" class="setting-input" id="set-repeat" min="0" max="20" value="0">
      </div>
      <div class="modal-btns">
        <button class="modal-btn secondary" onclick="hideSettings()">Cancel</button>
        <button class="modal-btn primary" onclick="saveSettings()">Save</button>
      </div>
    </div>
  </div>

  <div class="float float-timer" id="float-timer" onclick="switchSection('timer')">
    <div class="float-time" id="float-timer-time">25:00</div>
  </div>

  <div class="float float-clock" id="float-clock" onclick="switchSection('clock')">
    <div class="float-time" id="float-clock-time">00:00:00</div>
  </div>

  <div class="mobile-overlay" id="mobile-overlay" onclick="toggleSidebar()"></div>

  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">
        <div class="sidebar-logo-icon">W</div>
        <span>Work Hub</span>
      </div>
      <button class="sidebar-toggle" onclick="toggleSidebar()">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-section">
        <div class="nav-section-title">Main</div>
        <a class="nav-item active" onclick="switchSection('timer')">
          <div class="nav-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
          </div>
          <span class="nav-label">Timer</span>
          <span class="shortcut-hint">1</span>
        </a>
        <a class="nav-item" onclick="switchSection('clock')">
          <div class="nav-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
          </div>
          <span class="nav-label">Clock</span>
          <span class="shortcut-hint">2</span>
        </a>
        <a class="nav-item" onclick="switchSection('weather')">
          <div class="nav-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/>
            </svg>
          </div>
          <span class="nav-label">Weather</span>
          <span class="shortcut-hint">3</span>
        </a>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Tools</div>
        <a class="nav-item" onclick="switchSection('stopwatch')">
          <div class="nav-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="13" r="8"/>
              <path d="M12 9v4l2 2"/>
            </svg>
          </div>
          <span class="nav-label">Stopwatch</span>
          <span class="shortcut-hint">4</span>
        </a>
        <a class="nav-item" onclick="switchSection('custom-timer')">
          <div class="nav-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
          </div>
          <span class="nav-label">Custom Timer</span>
          <span class="shortcut-hint">5</span>
        </a>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Productivity</div>
        <a class="nav-item" onclick="switchSection('memo')">
          <div class="nav-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
            </svg>
          </div>
          <span class="nav-label">Memo</span>
          <span class="shortcut-hint">6</span>
        </a>
        <a class="nav-item" onclick="switchSection('notion')">
          <div class="nav-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 11 12 14 22 4"/>
              <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
            </svg>
          </div>
          <span class="nav-label">Notion</span>
          <span class="nav-badge">2</span>
        </a>
        <a class="nav-item" onclick="switchSection('gemini')">
          <div class="nav-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
            </svg>
          </div>
          <span class="nav-label">Gemini Chat</span>
          <span class="shortcut-hint">7</span>
        </a>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Settings</div>
        <a class="nav-item" onclick="showSettings()">
          <div class="nav-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"/>
              <path d="M12 1v6m0 6v6M1 12h6m6 0h6"/>
            </svg>
          </div>
          <span class="nav-label">Settings</span>
        </a>
      </div>
    </nav>
  </aside>

  <div class="main">
    <header class="header">
      <button class="header-btn" onclick="toggleSidebar()" style="display:none;" id="mobile-menu">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="3" y1="12" x2="21" y2="12"/>
          <line x1="3" y1="6" x2="21" y2="6"/>
          <line x1="3" y1="18" x2="21" y2="18"/>
        </svg>
      </button>

      <div class="search-wrap">
        <div class="search-icon">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.35-4.35"/>
          </svg>
        </div>
        <input type="text" class="search-box" id="search" placeholder="Search Google..." onkeypress="if(event.key==='Enter')doSearch()">
        <button class="search-btn" onclick="doSearch()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.35-4.35"/>
          </svg>
        </button>
      </div>

      <div class="header-actions">
        <button class="header-btn notify" title="Notifications">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
          </svg>
        </button>
        <button class="header-btn" onclick="showSettings()" title="Settings">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6M1 12h6m6 0h6"/>
          </svg>
        </button>
      </div>
    </header>

    <main class="content">
      <section class="section active" id="section-timer">
        <h1 class="section-title">Pomodoro Timer</h1>
        <div class="timer-hero">
          <div class="timer-tabs">
            <button class="tab-btn active" onclick="switchTimer('pomodoro')">Pomodoro</button>
            <button class="tab-btn" onclick="switchTimer('short')">Short Break</button>
            <button class="tab-btn" onclick="switchTimer('long')">Long Break</button>
          </div>
          <div class="timer-display" id="timer">25:00</div>
          <div class="timer-controls">
            <button class="ctrl-btn" id="start" onclick="toggleTimer()">Start</button>
            <button class="ctrl-btn" onclick="resetTimer()">Reset</button>
          </div>
        </div>
      </section>

      <section class="section" id="section-clock">
        <h1 class="section-title">World Clock</h1>
        <div class="cards">
          <div class="card wide">
            <div class="card-header">
              <div class="card-title">
                <div class="card-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 6 12 12 16 14"/>
                  </svg>
                </div>
                Local Time
              </div>
            </div>
            <div class="card-content">
              <div class="clock-time" id="time">00:00:00</div>
              <div class="clock-date" id="date">2024/1/1</div>
              <div class="world-clock-item"><span>üáØüáµ Tokyo</span><span id="tokyo">00:00:00</span></div>
              <div class="world-clock-item"><span>üá∫üá∏ New York</span><span id="ny">00:00:00</span></div>
              <div class="world-clock-item"><span>üá¨üáß London</span><span id="london">00:00:00</span></div>
            </div>
          </div>
        </div>
      </section>

      <section class="section" id="section-weather">
        <h1 class="section-title">Weather</h1>
        <div class="cards">
          <div class="card">
            <div class="card-header">
              <div class="card-title">
                <div class="card-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/>
                  </svg>
                </div>
                Current Weather
              </div>
            </div>
            <div class="card-content">
              <div class="weather-wrap">
                <div class="weather-icon-wrap">
                  <img id="w-icon" class="weather-icon" src="" alt="" style="display:none;">
                  <span class="weather-desc" id="w-desc">Loading...</span>
                </div>
                <div class="weather-temp" id="w-temp">--¬∞</div>
                <div class="weather-minmax">
                  <span>‚ñ≤ <span id="w-max">--</span>¬∞</span>
                  <span>‚ñº <span id="w-min">--</span>¬∞</span>
                </div>
                <div class="weather-loc" id="w-loc">--</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="section" id="section-stopwatch">
        <h1 class="section-title">Stopwatch</h1>
        <div class="cards">
          <div class="card">
            <div class="card-header">
              <div class="card-title">
                <div class="card-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="13" r="8"/>
                    <path d="M12 9v4l2 2"/>
                  </svg>
                </div>
                Stopwatch
              </div>
              <button class="card-action" onclick="resetSW()">Clear</button>
            </div>
            <div class="card-content">
              <div class="display-lg" id="sw">00:00:00</div>
              <div class="controls">
                <button class="btn" id="sw-btn" onclick="toggleSW()">Start</button>
                <button class="btn" onclick="lapSW()">Lap</button>
                <button class="btn" onclick="resetSW()">Reset</button>
              </div>
              <div class="lap-list" id="laps"></div>
            </div>
          </div>
        </div>
      </section>

      <section class="section" id="section-custom-timer">
        <h1 class="section-title">Custom Timer</h1>
        <div class="cards">
          <div class="card">
            <div class="card-header">
              <div class="card-title">
                <div class="card-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 6 12 12 16 14"/>
                  </svg>
                </div>
                Custom Timer
              </div>
            </div>
            <div class="card-content">
              <div class="display-lg" id="ct">00:00:00</div>
              <div class="input-group">
                <input type="number" class="input-sm" id="ct-h" value="0" min="0" max="23" placeholder="HH">
                <span>:</span>
                <input type="number" class="input-sm" id="ct-m" value="0" min="0" max="59" placeholder="MM">
                <span>:</span>
                <input type="number" class="input-sm" id="ct-s" value="0" min="0" max="59" placeholder="SS">
              </div>
              <div class="controls">
                <button class="btn" id="ct-btn" onclick="toggleCT()">Start</button>
                <button class="btn" onclick="resetCT()">Reset</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="section" id="section-memo">
        <h1 class="section-title">Memo</h1>
        <div class="cards">
          <div class="card wide tall">
            <div class="card-header">
              <div class="card-title">
                <div class="card-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                  </svg>
                </div>
                Notes
              </div>
              <button class="card-action" onclick="clearMemo()">Clear</button>
            </div>
            <div class="card-content">
              <div class="toolbar">
                <button class="toolbar-btn" onclick="fmt('bold')" title="Bold (Ctrl+B)">B</button>
                <button class="toolbar-btn" onclick="fmt('underline')" title="Underline (Ctrl+U)">U</button>
                <button class="toolbar-btn" onclick="fmt('larger')" title="Larger">A+</button>
                <button class="toolbar-btn" onclick="fmt('smaller')" title="Smaller">A-</button>
              </div>
              <div class="memo" id="memo" contenteditable="true" data-placeholder="Start typing..." onfocus="focused=this" oninput="saveMemo()"></div>
            </div>
          </div>
        </div>
      </section>

      <section class="section" id="section-notion">
        <h1 class="section-title">Notion Workspace</h1>
        <div class="cards">
          <div class="card wide tall">
            <div class="card-header">
              <div class="card-title">
                <div class="card-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9 11 12 14 22 4"/>
                    <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                  </svg>
                </div>
                Tasks
              </div>
              <div style="display:flex;gap:8px;">
                <button class="card-action" id="n-prev" style="display:none;" onclick="notionNav(-1)">‚Üê Prev</button>
                <button class="card-action" id="n-next" onclick="notionNav(1)">Next ‚Üí</button>
              </div>
            </div>
            <div class="card-content">
              <iframe class="notion-iframe" id="notion" src="https://todolist-home.notion.site/ebd//2c9ee93cc3e4800aba3ef91a7b2b0a31?v=2c9ee93cc3e480868d75000c8bfe4b7d" allowtransparency="true" allowfullscreen></iframe>
            </div>
          </div>
        </div>
      </section>

      <section class="section" id="section-gemini">
        <h1 class="section-title">Gemini Chat</h1>
        <div class="cards">
          <div class="card wide">
            <div class="card-header">
              <div class="card-title">
                <div class="card-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                  </svg>
                </div>
                AI Assistant
              </div>
            </div>
            <div class="card-content">
              <div class="gemini-wrap">
                <div class="gemini-input-wrap">
                  <div class="toolbar">
                    <button class="toolbar-btn" onclick="fmt('bold')" title="Bold">B</button>
                    <button class="toolbar-btn" onclick="fmt('underline')" title="Underline">U</button>
                    <button class="toolbar-btn" onclick="fmt('larger')" title="Larger">A+</button>
                    <button class="toolbar-btn" onclick="fmt('smaller')" title="Smaller">A-</button>
                  </div>
                  <div class="gemini-input" id="gemini" contenteditable="true" data-placeholder="Ask Gemini..." onfocus="focused=this" onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();sendGemini();}"></div>
                </div>
                <button class="gemini-send" onclick="sendGemini()">Send</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <div class="quick-actions">
    <button class="quick-btn" onclick="resetTimer()" title="Reset Timer">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="23 4 23 10 17 10"/>
        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
      </svg>
    </button>
    <button class="quick-btn" onclick="toggleTimer()" title="Start/Stop Timer">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polygon points="5 3 19 12 5 21 5 3"/>
      </svg>
    </button>
  </div>

  <audio id="snd-timer" preload="auto"><source src="./timer-sound.mp3" type="audio/mp3"></audio>
  <audio id="snd-click" preload="auto"><source src="./click.mp3" type="audio/mp3"></audio>
  <audio id="snd-lap" preload="auto"><source src="./lap.mp3" type="audio/mp3"></audio>
  <audio id="snd-pomo" preload="auto"><source src="./pomodoro.mp3" type="audio/mp3"></audio>

  <script>
    const $ = id => document.getElementById(id);
    const play = id => { const a = $(id); if(a) { a.currentTime = 0; a.play().catch(()=>{}); }};
    const pad = n => String(n).padStart(2, '0');
    const fmtTime = s => `${pad(Math.floor(s/60))}:${pad(s%60)}`;
    const fmtTime3 = s => `${pad(Math.floor(s/3600))}:${pad(Math.floor((s%3600)/60))}:${pad(s%60)}`;

    let focused = null, currentSection = 'timer', nPage = 0;

    // ËÉåÊôØ
    const bgImgs = Array.from({length: 16}, (_, i) => `background-image/bgimg-${i+1}.jpg`);
    const bg = document.querySelectorAll('.bg-img');
    let bgIdx = 0, bgVis = 0;
    setInterval(() => {
      const next = (bgVis + 1) % 2;
      bgIdx = (bgIdx + 1) % bgImgs.length;
      bg[next].src = bgImgs[bgIdx];
      bg[bgVis].classList.remove('active');
      bg[next].classList.add('active');
      bgVis = next;
    }, 10000);

    // „Çµ„Ç§„Éâ„Éê„Éº
    function toggleSidebar() {
      $('sidebar').classList.toggle(window.innerWidth <= 1024 ? 'open' : 'collapsed');
      $('mobile-overlay').classList.toggle('show');
      play('snd-click');
    }

    // „Çª„ÇØ„Ç∑„Éß„É≥Âàá„ÇäÊõø„Åà
    function switchSection(section) {
      play('snd-click');
      currentSection = section;
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      $(`section-${section}`).classList.add('active');
      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      event.target.closest('.nav-item').classList.add('active');
      if (window.innerWidth <= 1024) {
        $('sidebar').classList.remove('open');
        $('mobile-overlay').classList.remove('show');
      }
      checkVis();
    }

    // „Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà
    document.addEventListener('keydown', e => {
      if (e.target.tagName !== 'INPUT' && e.target.contentEditable !== 'true') {
        const key = e.key;
        if (key >= '1' && key <= '7') {
          const sections = ['timer', 'clock', 'weather', 'stopwatch', 'custom-timer', 'memo', 'gemini'];
          switchSection(sections[key - 1]);
        } else if (key === ' ' && currentSection === 'timer') {
          e.preventDefault();
          toggleTimer();
        }
      }
      
      if (focused) {
        if (e.ctrlKey && !e.shiftKey && e.key === 'b') { e.preventDefault(); fmt('bold'); }
        else if (e.ctrlKey && !e.shiftKey && e.key === 'u') { e.preventDefault(); fmt('underline'); }
        else if (e.ctrlKey && e.shiftKey && e.key === '>') { e.preventDefault(); fmt('larger'); }
        else if (e.ctrlKey && e.shiftKey && e.key === '<') { e.preventDefault(); fmt('smaller'); }
      }
    });

    // „Éï„Ç©„Éº„Éû„ÉÉ„Éà
    function fmt(a) {
      if (!focused) return;
      focused.focus();
      if (a === 'bold') document.execCommand('bold');
      else if (a === 'underline') document.execCommand('underline');
      else if (a === 'larger' || a === 'smaller') {
        const sel = window.getSelection();
        if (sel.rangeCount > 0 && !sel.isCollapsed) {
          const delta = a === 'larger' ? 2 : -2;
          const range = sel.getRangeAt(0);
          const span = document.createElement('span');
          try {
            range.surroundContents(span);
            span.style.fontSize = (parseFloat(getComputedStyle(span).fontSize) + delta) + 'px';
          } catch(e) {
            const frag = range.extractContents();
            span.appendChild(frag);
            span.style.fontSize = (parseFloat(getComputedStyle(focused).fontSize) + delta) + 'px';
            range.insertNode(span);
          }
        }
      }
    }

    // Ê§úÁ¥¢
    function doSearch() {
      const q = $('search').value.trim();
      if (q) {
        window.open('https://www.google.com/search?q=' + encodeURIComponent(q), '_blank');
        $('search').value = '';
      }
    }

    // Notion
    const nUrls = [
      'https://todolist-home.notion.site/ebd//2c9ee93cc3e4800aba3ef91a7b2b0a31?v=2c9ee93cc3e480868d75000c8bfe4b7d',
      'https://todolist-home.notion.site/ebd//2c9ee93cc3e480d0a9feecd8ab2bc460'
    ];
    function notionNav(d) {
      play('snd-click');
      nPage = d > 0 ? 1 : 0;
      $('notion').src = nUrls[nPage];
      $('n-prev').style.display = nPage ? 'inline-block' : 'none';
      $('n-next').style.display = nPage ? 'none' : 'inline-block';
    }
    setInterval(() => { $('notion').src = $('notion').src; }, 300000);

    // „Ç¢„É©„Éº„Éà
    function showAlert(title, msg) {
      $('alert-title').textContent = title;
      $('alert-msg').textContent = msg;
      $('alert').classList.add('show');
    }
    function hideAlert() { $('alert').classList.remove('show'); }

    // Ë®≠ÂÆö
    let sets = JSON.parse(localStorage.getItem('sets') || '{"work":25,"break":5,"repeat":0}');
    $('set-work').value = sets.work;
    $('set-break').value = sets.break;
    $('set-repeat').value = sets.repeat;

    function showSettings() {
      play('snd-click');
      $('settings').classList.add('show');
    }
    function saveSettings() {
      play('snd-click');
      sets.work = parseInt($('set-work').value) || 25;
      sets.break = parseInt($('set-break').value) || 5;
      sets.repeat = parseInt($('set-repeat').value) || 0;
      localStorage.setItem('sets', JSON.stringify(sets));
      pomoT = sets.work;
      shortT = sets.break;
      if (timerType === 'pomodoro') timeLeft = pomoT * 60;
      else if (timerType === 'short') timeLeft = shortT * 60;
      updateTimer();
      hideSettings();
    }
    function hideSettings() {
      play('snd-click');
      $('settings').classList.remove('show');
    }

    // Pomodoro
    let pomoT = sets.work, shortT = sets.break, longT = 15;
    let timerType = 'pomodoro', timeLeft = pomoT * 60, timerInt = null, timerRun = false;
    let cycles = 0, isWork = true;

    function updateTimer() {
      const str = fmtTime(timeLeft);
      $('timer').textContent = str;
      $('float-timer-time').textContent = str;
    }

    function switchTimer(type) {
      if (timerRun) {
        clearInterval(timerInt);
        timerRun = false;
        $('start').textContent = 'Start';
      }
      timerType = type;
      document.body.className = type === 'short' ? 'short-break' : type === 'long' ? 'long-break' : '';
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.tab-btn')[type === 'pomodoro' ? 0 : type === 'short' ? 1 : 2].classList.add('active');
      timeLeft = type === 'pomodoro' ? (isWork = true, pomoT * 60) : type === 'short' ? (isWork = false, shortT * 60) : (isWork = false, longT * 60);
      updateTimer();
    }

    function toggleTimer() {
      play('snd-click');
      if (timerRun) {
        clearInterval(timerInt);
        timerRun = false;
        $('start').textContent = 'Start';
      } else {
        timerRun = true;
        $('start').textContent = 'Stop';
        timerInt = setInterval(() => {
          if (--timeLeft <= 0) {
            clearInterval(timerInt);
            timerRun = false;
            $('start').textContent = 'Start';
            if (isWork) {
              cycles++;
              play('snd-pomo');
              showAlert('‰ΩúÊ•≠ÂÆå‰∫ÜÔºÅ', '‰ºëÊÜ©ÊôÇÈñì„Åß„Åô');
              if (sets.repeat === 0 || cycles < sets.repeat) {
                setTimeout(() => { switchTimer('short'); toggleTimer(); }, 3000);
              }
            } else {
              play('snd-timer');
              showAlert('‰ºëÊÜ©ÁµÇ‰∫ÜÔºÅ', 'Ê¨°„ÅÆ‰ΩúÊ•≠„ÇíÂßã„ÇÅ„Åæ„Åó„Çá„ÅÜ');
              if (sets.repeat === 0 || cycles < sets.repeat) {
                setTimeout(() => { switchTimer('pomodoro'); toggleTimer(); }, 3000);
              }
            }
          }
          updateTimer();
        }, 1000);
      }
    }

    function resetTimer() {
      play('snd-click');
      if (timerRun) {
        clearInterval(timerInt);
        timerRun = false;
        $('start').textContent = 'Start';
      }
      cycles = 0;
      switchTimer(timerType);
    }

    // „Éï„É≠„Éº„ÉÜ„Ç£„É≥„Ç∞Ë°®Á§∫Âà∂Âæ°
    function checkVis() {
      const scrollTop = document.querySelector('.content').scrollTop;
      const shouldShow = scrollTop > 200;
      $('float-timer').classList.toggle('show', shouldShow && currentSection !== 'timer');
      $('float-clock').classList.toggle('show', shouldShow && currentSection !== 'clock');
    }

    document.querySelector('.content').addEventListener('scroll', checkVis);
    window.addEventListener('resize', checkVis);

    // Custom Timer
    let ctTime = 0, ctInt = null, ctRun = false;
    function updateCT() { $('ct').textContent = fmtTime3(ctTime); }
    function toggleCT() {
      play('snd-click');
      if (ctRun) {
        clearInterval(ctInt);
        ctRun = false;
        $('ct-btn').textContent = 'Start';
      } else {
        if (ctTime === 0) {
          ctTime = (parseInt($('ct-h').value) || 0) * 3600 + (parseInt($('ct-m').value) || 0) * 60 + (parseInt($('ct-s').value) || 0);
          if (ctTime === 0) return alert('Please set the time');
        }
        ctRun = true;
        $('ct-btn').textContent = 'Stop';
        ctInt = setInterval(() => {
          if (--ctTime <= 0) {
            clearInterval(ctInt);
            ctRun = false;
            $('ct-btn').textContent = 'Start';
            play('snd-timer');
            showAlert('Time UpÔºÅ', '„Ç´„Çπ„Çø„É†„Çø„Ç§„Éû„Éº„ÅåÁµÇ‰∫Ü„Åó„Åæ„Åó„Åü');
          }
          updateCT();
        }, 1000);
      }
    }
    function resetCT() {
      play('snd-click');
      clearInterval(ctInt);
      ctRun = false;
      ctTime = 0;
      $('ct-btn').textContent = 'Start';
      $('ct-h').value = $('ct-m').value = $('ct-s').value = 0;
      updateCT();
    }

    // Stopwatch
    let swTime = 0, swInt = null, swRun = false, lapCnt = 0;
    function updateSW() { $('sw').textContent = fmtTime3(swTime); }
    function toggleSW() {
      play('snd-click');
      if (swRun) {
        clearInterval(swInt);
        swRun = false;
        $('sw-btn').textContent = 'Start';
      } else {
        swRun = true;
        $('sw-btn').textContent = 'Stop';
        swInt = setInterval(() => { swTime++; updateSW(); }, 1000);
      }
    }
    function lapSW() {
      if (swRun) {
        play('snd-lap');
        const lap = document.createElement('div');
        lap.className = 'lap-item';
        lap.innerHTML = `<span>Lap ${++lapCnt}</span><span>${fmtTime3(swTime)}</span>`;
        $('laps').insertBefore(lap, $('laps').firstChild);
      }
    }
    function resetSW() {
      play('snd-click');
      clearInterval(swInt);
      swRun = false;
      swTime = lapCnt = 0;
      $('sw-btn').textContent = 'Start';
      $('laps').innerHTML = '';
      updateSW();
    }

    // Memo
    const memo = $('memo');
    if (localStorage.memo) memo.innerHTML = localStorage.memo;
    function saveMemo() { localStorage.memo = memo.innerHTML; }
    function clearMemo() {
      if (confirm('Clear all notes?')) {
        memo.innerHTML = '';
        localStorage.removeItem('memo');
      }
    }

    // Clock
    function updateClocks() {
      const now = new Date();
      const t = fmtTime3(now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds());
      $('time').textContent = t;
      $('float-clock-time').textContent = t;
      const wd = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'][now.getDay()];
      $('date').textContent = `${now.getFullYear()}/${now.getMonth()+1}/${now.getDate()} (${wd})`;
      const getTZ = tz => {
        const d = new Date(now.toLocaleString('en-US', {timeZone: tz}));
        return fmtTime3(d.getHours()*3600+d.getMinutes()*60+d.getSeconds());
      };
      $('tokyo').textContent = getTZ('Asia/Tokyo');
      $('ny').textContent = getTZ('America/New_York');
      $('london').textContent = getTZ('Europe/London');
    }
    updateClocks();
    setInterval(updateClocks, 1000);

    // Weather
    function loadWeather() {
      fetch(`https://api.openweathermap.org/data/2.5/weather?lat=35.85272206403399&lon=136.28673448772105&appid=8eb6dc5492a964ea79dd0ef92f1ae01c&units=metric&lang=ja`)
        .then(r => r.json())
        .then(d => {
          $('w-icon').src = `./weather-svg/${d.weather[0].icon}.svg`;
          $('w-icon').style.display = 'block';
          $('w-desc').textContent = d.weather[0].description;
          $('w-temp').textContent = Math.round(d.main.temp) + '¬∞';
          $('w-max').textContent = Math.round(d.main.temp_max);
          $('w-min').textContent = Math.round(d.main.temp_min);
          $('w-loc').textContent = d.name || 'ÊåáÂÆöÂú∞ÁÇπ';
        })
        .catch(e => { $('w-desc').textContent = 'Error loading weather'; });
    }
    loadWeather();
    setInterval(loadWeather, 1800000);

    // Gemini
    function sendGemini() {
      const msg = $('gemini').textContent.trim();
      if (!msg) return;
      $('gemini').textContent = '';
      console.log('Message sent to Gemini:', msg);
    }

    // ÂàùÊúüÂåñ
    updateTimer();
    updateCT();
    updateSW();
    checkVis();

    // „É¨„Çπ„Éù„É≥„Ç∑„Éñ
    window.addEventListener('resize', () => {
      if (window.innerWidth > 1024) {
        $('sidebar').classList.remove('open');
        $('mobile-overlay').classList.remove('show');
        $('mobile-menu').style.display = 'none';
      } else {
        $('mobile-menu').style.display = 'flex';
      }
    });

    // ÂàùÊúüË°®Á§∫Ë®≠ÂÆö
    if (window.innerWidth <= 1024) {
      $('mobile-menu').style.display = 'flex';
    }
  </script>
</body>
</html>